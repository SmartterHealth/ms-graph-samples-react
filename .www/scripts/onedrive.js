!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}([function(e,t){e.exports=React},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(r,a){function s(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(s,o)}c((i=i.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const r=n(7);let a=null;class s{constructor(){this._msalConfig={auth:{clientId:"ce0b75e9-40dd-4f23-855e-0242fab3fea9",authority:"https://login.microsoftonline.com/smartterhealth.com"},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:!0}},this._msalInstance=new r.UserAgentApplication(this._msalConfig)}get account(){return this._msalInstance.getAccount()}get isLoggedIn(){return null!=this.account}static getInstance(){return null===a&&(a=new s),a}getAccessToken(){return i(this,void 0,void 0,function*(){const e={scopes:["https://graph.microsoft.com/.default"]};return console.log(e),(yield this._msalInstance.acquireTokenSilent(e)).accessToken})}getAccessToken2(e=["https://graph.microsoft.com/.default"]){return i(this,void 0,void 0,function*(){if(this.isLoggedIn)return this._msalInstance.acquireTokenSilent({scopes:e})})}login(){return i(this,void 0,void 0,function*(){yield this._msalInstance.loginPopup(this._msalRequest);return{status:o.LoggedIn,message:"The user has been logged in"}})}logout(){return i(this,void 0,void 0,function*(){return yield this._msalInstance.logout(),{status:o.LoggedOut,message:"The user has been logged out"}})}authProvider(){return this._msalInstance}}var o;t.AuthenticationProvider=s,function(e){e[e.LoggedOut=0]="LoggedOut",e[e.LoggedIn=1]="LoggedIn"}(o=t.AuthenticationStatus||(t.AuthenticationStatus={}))},function(e,t){e.exports=MicrosoftGraph},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(r,a){function s(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(s,o)}c((i=i.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),a=n(4),s=n(2),o=n(5),c=n(8),l=n(1).AuthenticationProvider.getInstance();const d=document.getElementById("app-root");a.render(r.createElement(class extends r.Component{constructor(e){super(e),this.state={driveItems:[]},this.handleClick=this.handleClick.bind(this),this.handleRecentItemsTabClicked=this.handleRecentItemsTabClicked.bind(this),this.handlehandleSharedWithMeTabClicked=this.handlehandleSharedWithMeTabClicked.bind(this)}handleRecentItemsTabClicked(e){return i(this,void 0,void 0,function*(){this.setState({driveItems:[]});const e={authProvider:l,scopes:["https://graph.microsoft.com/.default"]},t=s.Client.initWithMiddleware(e),n=yield t.api("/me/drive/recent").top(15).get();this.setState({driveItems:n.value})})}handlehandleSharedWithMeTabClicked(e){return i(this,void 0,void 0,function*(){this.setState({driveItems:[]});const e={authProvider:l,scopes:["https://graph.microsoft.com/.default"]},t=s.Client.initWithMiddleware(e),n=yield t.api("/me/drive/sharedWithMe").top(15).get();console.log(n.value.length),this.setState({driveItems:n.value})})}render(){return r.createElement("div",{className:"container"},r.createElement(c.Header,null),r.createElement(o.OneDrivePanel,{maxDriveItems:25}))}handleClick(e){return i(this,void 0,void 0,function*(){const e={authProvider:l,scopes:["https://graph.microsoft.com/.default"]},t=s.Client.initWithMiddleware(e),n=yield t.api("/me/drive/recent").top(15).get();this.setState({driveItems:n.value})})}},null),d)},function(e,t){e.exports=ReactDOM},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(r,a){function s(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(s,o)}c((i=i.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),a=n(6),s=n(1),o=n(2),c=s.AuthenticationProvider.getInstance(),l=c.isLoggedIn;function d(e,t=25){return i(this,void 0,void 0,function*(){const e={authProvider:c,scopes:["https://graph.microsoft.com/.default"]},n=o.Client.initWithMiddleware(e),i=yield n.api("/me/drive/sharedWithMe").top(t).get();return console.log(i.value.length),i.value})}t.OneDrivePanel=function(e){const[t,n]=r.useState({driveItems:[]}),s="tab col s4"+(l?"":" disabled");return r.createElement("div",{id:"onedrive-panel"},r.createElement("div",{className:"row",id:"onedrive-tabs"},r.createElement("div",{className:"col s12"},r.createElement("ul",{className:"tabs"},r.createElement("li",{className:"tab col s4"},r.createElement("a",{href:"#m-tab-welcome"},"Welcome")),r.createElement("li",{className:s},r.createElement("a",{href:"#m-tab-recent-items",onClick:t=>i(this,void 0,void 0,function*(){n({driveItems:[]}),d("/me/drive/recent",e.maxDriveItems).then(e=>{n({driveItems:e})})})},"Recent Items")),r.createElement("li",{className:s},r.createElement("a",{href:"#m-tab-shared-with-me",onClick:t=>i(this,void 0,void 0,function*(){n({driveItems:[]}),d("/me/drive/sharedWithMe",e.maxDriveItems).then(e=>{n({driveItems:e})})})},"Shared With Me"))))),r.createElement("div",{className:"row"},r.createElement("div",{id:"m-tab-welcome",className:"col s12"},r.createElement("h2",null,"Welcome!")),r.createElement("div",{id:"m-tab-recent-items",className:"col s12"},r.createElement(a.DriveItemCardList,{driveItems:t.driveItems})),r.createElement("div",{id:"m-tab-shared-with-me",className:"col s12"},r.createElement(a.DriveItemCardList,{driveItems:t.driveItems}))))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0);function r(e){const t=e.driveItem;return i.createElement("div",{className:"card"},i.createElement("div",{className:"card-title"},t.name),i.createElement("div",{className:"card-action"},i.createElement("a",{href:t.webUrl},"Open")))}t.DriveItemCardList=function(e){const t=e.driveItems.map((e,t)=>i.createElement(r,{driveItem:e}));return e.driveItems&&e.driveItems.length>0?i.createElement("div",null," ",t," "):i.createElement("h3",null,"Loading... please wait.")},t.DriveItemCard=r},function(e,t){e.exports=Msal},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),r=n(9),a={padding:"10px"};t.Header=e=>i.createElement("div",null,i.createElement("nav",{className:"light-blue darken-4"},i.createElement("div",{className:"nav-wrapper",style:a},i.createElement("a",{href:"#",className:"brand-logo"},"OneDrive"),i.createElement("ul",{id:"nav-mobile",className:"right hide-on-med-and-down"},i.createElement("li",null,i.createElement(r.LoginButton,{class:"btn light-blue lighten-4 black-text"}))))))},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(r,a){function s(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(s,o)}c((i=i.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),a=n(1),s=a.AuthenticationProvider.getInstance();t.LoginButton=class extends r.Component{constructor(e){super(e),this.handleClick=this.handleClick.bind(this),this.state={isLoggedIn:s.isLoggedIn}}render(){return r.createElement("button",{className:this.props.class?this.props.class:"btn",onClick:this.handleClick}," ",this.state.isLoggedIn?"Logout":"Login"," ")}handleClick(e){return i(this,void 0,void 0,function*(){this.state.isLoggedIn?confirm("Do you really wish to log out?")&&s.logout().then(e=>{this.setState({isLoggedIn:e.status==a.AuthenticationStatus.LoggedIn})}):s.login().then(e=>{this.setState({isLoggedIn:e.status==a.AuthenticationStatus.LoggedIn})})})}}}]);
//# sourceMappingURL=onedrive.js.map